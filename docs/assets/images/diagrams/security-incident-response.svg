<?xml version="1.0" encoding="UTF-8"?>
<svg width="900" height="600" viewBox="0 0 900 600" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .title { font-family: 'Noto Sans JP', sans-serif; font-size: 20px; font-weight: bold; fill: #2c3e50; }
      .phase-title { font-family: 'Noto Sans JP', sans-serif; font-size: 14px; font-weight: bold; fill: #fff; }
      .activity-text { font-family: 'Noto Sans JP', sans-serif; font-size: 11px; fill: #2c3e50; }
      .small-text { font-family: 'Noto Sans JP', sans-serif; font-size: 10px; fill: #7f8c8d; }
      .prepare-phase { fill: #3498db; stroke: #2980b9; stroke-width: 2; }
      .detect-phase { fill: #f39c12; stroke: #e67e22; stroke-width: 2; }
      .contain-phase { fill: #e74c3c; stroke: #c0392b; stroke-width: 2; }
      .eradicate-phase { fill: #9b59b6; stroke: #8e44ad; stroke-width: 2; }
      .recover-phase { fill: #2ecc71; stroke: #27ae60; stroke-width: 2; }
      .improve-phase { fill: #34495e; stroke: #2c3e50; stroke-width: 2; }
      .activity-box { fill: #fff; stroke: #95a5a6; stroke-width: 1; }
      .flow-arrow { stroke: #34495e; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
      .feedback-arrow { stroke: #95a5a6; stroke-width: 1; stroke-dasharray: 5,3; fill: none; marker-end: url(#arrowhead-gray); }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#34495e"/>
    </marker>
    <marker id="arrowhead-gray" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#95a5a6"/>
    </marker>
  </defs>

  <!-- Title -->
  <text x="450" y="30" class="title" text-anchor="middle">セキュリティインシデント対応プロセス</text>

  <!-- Phase 1: Preparation -->
  <g id="prepare">
    <rect x="50" y="80" width="120" height="80" class="prepare-phase" rx="5"/>
    <text x="110" y="105" class="phase-title" text-anchor="middle">1. 準備</text>
    <text x="110" y="125" class="phase-title" text-anchor="middle">Preparation</text>
    
    <rect x="40" y="180" width="140" height="100" class="activity-box" rx="3"/>
    <text x="110" y="200" class="activity-text" text-anchor="middle" font-weight="bold">活動内容</text>
    <text x="50" y="220" class="small-text">• チーム編成</text>
    <text x="50" y="235" class="small-text">• ツール準備</text>
    <text x="50" y="250" class="small-text">• 手順書作成</text>
    <text x="50" y="265" class="small-text">• 訓練実施</text>
  </g>

  <!-- Phase 2: Detection -->
  <g id="detect">
    <rect x="210" y="80" width="120" height="80" class="detect-phase" rx="5"/>
    <text x="270" y="105" class="phase-title" text-anchor="middle">2. 検知・分析</text>
    <text x="270" y="125" class="phase-title" text-anchor="middle">Detection</text>
    
    <rect x="200" y="180" width="140" height="100" class="activity-box" rx="3"/>
    <text x="270" y="200" class="activity-text" text-anchor="middle" font-weight="bold">活動内容</text>
    <text x="210" y="220" class="small-text">• アラート監視</text>
    <text x="210" y="235" class="small-text">• ログ分析</text>
    <text x="210" y="250" class="small-text">• 影響範囲特定</text>
    <text x="210" y="265" class="small-text">• 優先度判定</text>
  </g>

  <!-- Phase 3: Containment -->
  <g id="contain">
    <rect x="370" y="80" width="120" height="80" class="contain-phase" rx="5"/>
    <text x="430" y="105" class="phase-title" text-anchor="middle">3. 封じ込め</text>
    <text x="430" y="125" class="phase-title" text-anchor="middle">Containment</text>
    
    <rect x="360" y="180" width="140" height="100" class="activity-box" rx="3"/>
    <text x="430" y="200" class="activity-text" text-anchor="middle" font-weight="bold">活動内容</text>
    <text x="370" y="220" class="small-text">• 短期封じ込め</text>
    <text x="370" y="235" class="small-text">• システム隔離</text>
    <text x="370" y="250" class="small-text">• 証拠保全</text>
    <text x="370" y="265" class="small-text">• 長期封じ込め</text>
  </g>

  <!-- Phase 4: Eradication -->
  <g id="eradicate">
    <rect x="530" y="80" width="120" height="80" class="eradicate-phase" rx="5"/>
    <text x="590" y="105" class="phase-title" text-anchor="middle">4. 根絶</text>
    <text x="590" y="125" class="phase-title" text-anchor="middle">Eradication</text>
    
    <rect x="520" y="180" width="140" height="100" class="activity-box" rx="3"/>
    <text x="590" y="200" class="activity-text" text-anchor="middle" font-weight="bold">活動内容</text>
    <text x="530" y="220" class="small-text">• マルウェア除去</text>
    <text x="530" y="235" class="small-text">• 脆弱性修正</text>
    <text x="530" y="250" class="small-text">• システム強化</text>
    <text x="530" y="265" class="small-text">• パッチ適用</text>
  </g>

  <!-- Phase 5: Recovery -->
  <g id="recover">
    <rect x="690" y="80" width="120" height="80" class="recover-phase" rx="5"/>
    <text x="750" y="105" class="phase-title" text-anchor="middle">5. 復旧</text>
    <text x="750" y="125" class="phase-title" text-anchor="middle">Recovery</text>
    
    <rect x="680" y="180" width="140" height="100" class="activity-box" rx="3"/>
    <text x="750" y="200" class="activity-text" text-anchor="middle" font-weight="bold">活動内容</text>
    <text x="690" y="220" class="small-text">• システム復旧</text>
    <text x="690" y="235" class="small-text">• 監視強化</text>
    <text x="690" y="250" class="small-text">• 正常性確認</text>
    <text x="690" y="265" class="small-text">• 運用再開</text>
  </g>

  <!-- Phase 6: Lessons Learned -->
  <g id="improve">
    <rect x="370" y="320" width="160" height="80" class="improve-phase" rx="5"/>
    <text x="450" y="345" class="phase-title" text-anchor="middle">6. 事後対応</text>
    <text x="450" y="365" class="phase-title" text-anchor="middle">Lessons Learned</text>
    
    <rect x="360" y="420" width="180" height="100" class="activity-box" rx="3"/>
    <text x="450" y="440" class="activity-text" text-anchor="middle" font-weight="bold">活動内容</text>
    <text x="370" y="460" class="small-text">• インシデント報告書作成</text>
    <text x="370" y="475" class="small-text">• 振り返り会議実施</text>
    <text x="370" y="490" class="small-text">• プロセス改善</text>
    <text x="370" y="505" class="small-text">• 再発防止策実施</text>
  </g>

  <!-- Flow Arrows -->
  <path d="M 170 120 L 210 120" class="flow-arrow"/>
  <path d="M 330 120 L 370 120" class="flow-arrow"/>
  <path d="M 490 120 L 530 120" class="flow-arrow"/>
  <path d="M 650 120 L 690 120" class="flow-arrow"/>
  <path d="M 750 160 Q 750 360 530 360" class="flow-arrow"/>
  
  <!-- Feedback Loop -->
  <path d="M 370 360 Q 110 300 110 160" class="feedback-arrow"/>
  <text x="200" y="340" class="small-text" text-anchor="middle">継続的改善</text>

  <!-- Timeline and Metrics -->
  <g id="metrics">
    <rect x="50" y="540" width="800" height="40" fill="#f8f9fa" stroke="#dee2e6" stroke-width="1" rx="5"/>
    <text x="110" y="565" class="activity-text" font-weight="bold">目標時間:</text>
    <text x="210" y="565" class="small-text">検知 &lt;1時間</text>
    <text x="320" y="565" class="small-text">初動対応 &lt;4時間</text>
    <text x="450" y="565" class="small-text">封じ込め &lt;24時間</text>
    <text x="580" y="565" class="small-text">復旧 &lt;72時間</text>
    <text x="700" y="565" class="small-text">報告書 &lt;2週間</text>
  </g>
</svg>