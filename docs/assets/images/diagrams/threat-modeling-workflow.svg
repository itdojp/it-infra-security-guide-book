<?xml version="1.0" encoding="UTF-8"?>
<svg width="800" height="600" viewBox="0 0 800 600" xmlns="http://www.w3.org/2000/svg">
  <title>脅威モデリングワークフロー（STRIDE方法論）</title>
  <desc>STRIDEフレームワークを使用した脅威モデリングプロセスの完全な視覚化フロー図</desc>
  <defs>
    <style>
      :root {
        --svg-bg: #ffffff;
        --svg-text: #1a1a1a;
        --svg-primary: #0066cc;
        --svg-success: #16a34a;
        --svg-warning: #ca8a04;
        --svg-error: #dc2626;
        --svg-neutral: #6b7280;
      }
      .title-text { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji'; font-size: 16px; font-weight: 600; fill: var(--svg-text); }
      .phase-title { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji'; font-size: 12px; font-weight: 500; fill: var(--svg-bg); }
      .stride-text { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji'; font-size: 12px; font-weight: 400; fill: var(--svg-text); }
      .annotation-text { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji'; font-size: 10px; font-weight: 400; fill: var(--svg-neutral); }
      .preparation-box { fill: var(--svg-primary); stroke: var(--svg-primary); stroke-width: 2; }
      .modeling-box { fill: var(--svg-warning); stroke: var(--svg-warning); stroke-width: 2; }
      .analysis-box { fill: var(--svg-error); stroke: var(--svg-error); stroke-width: 2; }
      .mitigation-box { fill: var(--svg-success); stroke: var(--svg-success); stroke-width: 2; }
      .workflow-arrow { stroke: var(--svg-primary); stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
      .stride-category { fill: var(--svg-neutral); stroke: var(--svg-neutral); stroke-width: 2; }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="var(--svg-primary)"/>
    </marker>
  </defs>

  <!-- Title -->
  <text x="400" y="30" class="title-text" text-anchor="middle">脅威モデリングワークフロー（STRIDE方法論）</text>

  <!-- Phase 1: Preparation -->
  <g id="preparation-phase">
    <rect x="60" y="60" width="160" height="100" class="preparation-box" rx="4"/>
    <text x="140" y="80" class="phase-title" text-anchor="middle">1. 準備フェーズ</text>
    
    <rect x="80" y="90" width="120" height="60" fill="var(--svg-bg)" stroke="var(--svg-primary)" stroke-width="1" rx="4"/>
    <text x="140" y="105" class="stride-text" text-anchor="middle" font-weight="500">スコープ定義</text>
    <text x="90" y="120" class="annotation-text">• システム境界</text>
    <text x="90" y="135" class="annotation-text">• 資産識別</text>
    <text x="90" y="145" class="annotation-text">• 前提条件</text>
  </g>

  <!-- Phase 2: System Modeling -->
  <g id="modeling-phase">
    <rect x="240" y="60" width="160" height="100" class="modeling-box" rx="4"/>
    <text x="320" y="80" class="phase-title" text-anchor="middle">2. システムモデリング</text>
    
    <rect x="260" y="90" width="120" height="60" fill="var(--svg-bg)" stroke="var(--svg-warning)" stroke-width="1" rx="4"/>
    <text x="320" y="105" class="stride-text" text-anchor="middle" font-weight="500">DFD作成</text>
    <text x="270" y="120" class="annotation-text">• データフロー図</text>
    <text x="270" y="135" class="annotation-text">• 信頼境界</text>
    <text x="270" y="145" class="annotation-text">• エントリポイント</text>
  </g>

  <!-- Phase 3: Threat Analysis -->
  <g id="analysis-phase">
    <rect x="420" y="60" width="160" height="100" class="analysis-box" rx="4"/>
    <text x="500" y="80" class="phase-title" text-anchor="middle">3. 脅威分析</text>
    
    <rect x="440" y="90" width="120" height="60" fill="var(--svg-bg)" stroke="var(--svg-error)" stroke-width="1" rx="4"/>
    <text x="500" y="105" class="stride-text" text-anchor="middle" font-weight="500">STRIDE適用</text>
    <text x="450" y="120" class="annotation-text">• 脅威識別</text>
    <text x="450" y="135" class="annotation-text">• リスク評価</text>
    <text x="450" y="145" class="annotation-text">• 優先順位付け</text>
  </g>

  <!-- Phase 4: Mitigation -->
  <g id="mitigation-phase">
    <rect x="600" y="60" width="160" height="100" class="mitigation-box" rx="4"/>
    <text x="680" y="80" class="phase-title" text-anchor="middle">4. 対策フェーズ</text>
    
    <rect x="620" y="90" width="120" height="60" fill="var(--svg-bg)" stroke="var(--svg-success)" stroke-width="1" rx="4"/>
    <text x="680" y="105" class="stride-text" text-anchor="middle" font-weight="500">対策実装</text>
    <text x="630" y="120" class="annotation-text">• 制御設計</text>
    <text x="630" y="135" class="annotation-text">• 実装計画</text>
    <text x="630" y="145" class="annotation-text">• 検証</text>
  </g>

  <!-- STRIDE Categories -->
  <g id="stride-categories">
    <rect x="80" y="190" width="640" height="240" fill="var(--svg-neutral)" fill-opacity="0.05" stroke="var(--svg-text)" stroke-width="2" rx="4"/>
    <text x="400" y="210" class="stride-text" text-anchor="middle" font-weight="500">STRIDE脅威カテゴリ詳細</text>
    
    <!-- Spoofing -->
    <rect x="100" y="230" width="180" height="60" class="stride-category" rx="4"/>
    <text x="190" y="250" class="phase-title" text-anchor="middle">S - なりすまし</text>
    <text x="110" y="265" class="annotation-text">• 認証バイパス</text>
    <text x="110" y="280" class="annotation-text">• 対策: MFA、証明書</text>
    
    <!-- Tampering -->
    <rect x="300" y="230" width="180" height="60" class="stride-category" rx="4"/>
    <text x="390" y="250" class="phase-title" text-anchor="middle">T - 改ざん</text>
    <text x="310" y="265" class="annotation-text">• データ改変</text>
    <text x="310" y="280" class="annotation-text">• 対策: 完全性チェック</text>
    
    <!-- Repudiation -->
    <rect x="500" y="230" width="180" height="60" class="stride-category" rx="4"/>
    <text x="590" y="250" class="phase-title" text-anchor="middle">R - 否認</text>
    <text x="510" y="265" class="annotation-text">• 行為の否定</text>
    <text x="510" y="280" class="annotation-text">• 対策: 監査ログ</text>
    
    <!-- Information Disclosure -->
    <rect x="100" y="310" width="180" height="60" class="stride-category" rx="4"/>
    <text x="190" y="330" class="phase-title" text-anchor="middle">I - 情報漏洩</text>
    <text x="110" y="345" class="annotation-text">• 機密データ露出</text>
    <text x="110" y="360" class="annotation-text">• 対策: 暗号化</text>
    
    <!-- Denial of Service -->
    <rect x="300" y="310" width="180" height="60" class="stride-category" rx="4"/>
    <text x="390" y="330" class="phase-title" text-anchor="middle">D - サービス拒否</text>
    <text x="310" y="345" class="annotation-text">• リソース枯渇</text>
    <text x="310" y="360" class="annotation-text">• 対策: レート制限</text>
    
    <!-- Elevation of Privilege -->
    <rect x="500" y="310" width="180" height="60" class="stride-category" rx="4"/>
    <text x="590" y="330" class="phase-title" text-anchor="middle">E - 権限昇格</text>
    <text x="510" y="345" class="annotation-text">• 不正な権限取得</text>
    <text x="510" y="360" class="annotation-text">• 対策: 最小権限原則</text>
  </g>

  <!-- Workflow Arrows -->
  <path d="M 220 110 L 240 110" class="workflow-arrow"/>
  <path d="M 400 110 L 420 110" class="workflow-arrow"/>
  <path d="M 580 110 L 600 110" class="workflow-arrow"/>

  <!-- Risk Assessment Matrix -->
  <g id="risk-matrix">
    <rect x="100" y="450" width="600" height="120" fill="var(--svg-primary)" fill-opacity="0.05" stroke="var(--svg-primary)" stroke-width="2" rx="4"/>
    <text x="400" y="470" class="stride-text" text-anchor="middle" font-weight="500">リスク評価マトリックス</text>
    
    <!-- Matrix Grid -->
    <g id="matrix-grid">
      <!-- High Risk -->
      <rect x="120" y="490" width="60" height="60" fill="var(--svg-error)" fill-opacity="0.3" stroke="var(--svg-error)" stroke-width="1"/>
      <text x="150" y="520" class="annotation-text" text-anchor="middle">高</text>
      
      <!-- Medium Risk -->
      <rect x="190" y="490" width="60" height="60" fill="var(--svg-warning)" fill-opacity="0.3" stroke="var(--svg-warning)" stroke-width="1"/>
      <text x="220" y="520" class="annotation-text" text-anchor="middle">中</text>
      
      <!-- Low Risk -->
      <rect x="260" y="490" width="60" height="60" fill="var(--svg-success)" fill-opacity="0.3" stroke="var(--svg-success)" stroke-width="1"/>
      <text x="290" y="520" class="annotation-text" text-anchor="middle">低</text>
    </g>
    
    <!-- Priority Actions -->
    <text x="400" y="500" class="annotation-text" font-weight="500">対応優先度</text>
    <text x="400" y="515" class="annotation-text">• 緊急: 高リスク脅威（24時間以内）</text>
    <text x="400" y="530" class="annotation-text">• 重要: 中リスク脅威（1週間以内）</text>
    <text x="400" y="545" class="annotation-text">• 計画: 低リスク脅威（次回リリース）</text>
  </g>
</svg>